INFO:     Will watch for changes in these directories: ['c:\\Virtual Try-On - AWS\\Emergent-Virtual-Tryon\\backend']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [42076] using StatReload
pybullet build time: Sep 23 2025 15:48:47
[OK] AI/ML libraries loaded successfully
[OK] 3D mesh processing libraries loaded
[OK] Physics simulation available
[DEBUG] DEBUGGING: Getting MONGO_URL from environment...
[DEBUG] Raw MONGO_URL from environment: 'mongodb://localhost:27017'
[DEBUG] MONGO_URL type: <class 'str'>
[DEBUG] MONGO_URL length: 25
[DEBUG] MONGO_URL after strip: 'mongodb://localhost:27017'
[OK] MongoDB URL already has correct scheme
[DEBUG] Final MONGO_URL value: 'mongodb://localhost:27017'
[CORS] Configured origins: *
Loading pipeline components...:   0%|          | 0/6 [00:00<?, ?it/s]Loading pipeline components...:  50%|#####     | 3/6 [00:00<00:00,  6.92it/s]`torch_dtype` is deprecated! Use `dtype` instead!
Loading pipeline components...:  67%|######6   | 4/6 [00:00<00:00,  6.68it/s]Loading pipeline components...:  83%|########3 | 5/6 [00:00<00:00,  6.72it/s]Loading pipeline components...: 100%|##########| 6/6 [00:01<00:00,  5.02it/s]Loading pipeline components...: 100%|##########| 6/6 [00:01<00:00,  5.70it/s]
INFO:     Started server process [24788]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
[OK] Stable Diffusion pipeline initialized
[WARN] Integration API not available: No module named 'google'
FastAPI application starting up...
MongoDB URL configured, initializing database connection...
Initializing MongoDB connection (attempt 1/3)...
Creating AsyncIOMotorClient with URL: mongodb://localhost:27017...
MongoDB connection successful
Products collection already exists with 3 items
Database indexes created
Database initialization completed successfully
FastAPI startup completed - ready to serve requests
INFO:     127.0.0.1:54236 - "OPTIONS /api/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:54236 - "POST /api/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:54236 - "OPTIONS /api/profile HTTP/1.1" 200 OK
INFO:     127.0.0.1:54236 - "GET /api/profile HTTP/1.1" 200 OK
INFO:     127.0.0.1:54236 - "OPTIONS /api/tryon-history HTTP/1.1" 200 OK
INFO:     127.0.0.1:54236 - "GET /api/tryon-history HTTP/1.1" 200 OK
INFO:     127.0.0.1:54236 - "GET /api/tryon-history HTTP/1.1" 200 OK
INFO:     127.0.0.1:54236 - "OPTIONS /api/products HTTP/1.1" 200 OK
INFO:     127.0.0.1:54236 - "GET /api/products HTTP/1.1" 200 OK
INFO:     127.0.0.1:54236 - "GET /api/products HTTP/1.1" 200 OK
INFO:     127.0.0.1:53498 - "OPTIONS /api/tryon HTTP/1.1" 200 OK
MediaPipe not available
[API] Enhanced virtual try-on request from matthew.adebayo@nynox.solutions
[API] Using uploaded garment image (base64)
[API] FASHN processing failed: No module named 'google', falling back to local
[WARN] MediaPipe not available in PrecisePoseDetector - using fallback mode
[WARN] MediaPipe not available: No module named 'mediapipe'
[INFO] Falling back to basic image analysis without pose detection
[CUSTOMER] Analysis result keys: ['pose_landmarks', 'pose_keypoints', 'measurements', 'body_segmentation', 'skin_tone', 'scale_info', 'image_shape', 'analysis_success', 'confidence_score', 'pose_suitable_for_tryon', 'pose_confidence']
[CUSTOMER] Pose keypoints: False
[CUSTOMER] Pose suitable for try-on: False
[CUSTOMER] Pose confidence: 0.00
[CUSTOMER] Measurements: {'shoulder_width_cm': 45.0, 'height_cm': 170.0, 'confidence_scores': {}, 'overall_confidence': 0.3}
[GARMENT] Image shape: (512, 512, 3)
[GARMENT] Image min/max values: 0/255
[GARMENT] Total pixels: 262144
[GARMENT] Average color of entire image: [181.50802231 198.72179794 196.94791794]
[GARMENT] Filtered pixels (30-225 range): 99791
[GARMENT] White pixels (>200): 160477/262144 (61.2%)
[GARMENT] K-means cluster centers: [[ 64 109 104]
 [169 191 188]
 [ 53  96  92]
 [103 144 139]
 [ 76 122 117]]
[GARMENT] Color frequencies: [(array([ 64, 109, 104]), 39797), (array([53, 96, 92]), 28126), (array([ 76, 122, 117]), 25940), (array([103, 144, 139]), 5048), (array([169, 191, 188]), 880)]
[GARMENT] Final primary color: (64, 109, 104)
[GARMENT] Full palette: [(64, 109, 104), (53, 96, 92), (76, 122, 117), (103, 144, 139), (169, 191, 188)]
[GARMENT] Analysis complete - dominant_colors: [(64, 109, 104), (53, 96, 92), (76, 122, 117), (103, 144, 139), (169, 191, 188)]
[ERROR] Virtual try-on failed: 500: Customer pose detection failed
INFO:     127.0.0.1:53498 - "POST /api/tryon HTTP/1.1" 500 Internal Server Error
WARNING:  StatReload detected changes in 'src\core\customer_image_analyzer.py'. Reloading...
INFO:     127.0.0.1:56830 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:61417 - "OPTIONS /api/profile HTTP/1.1" 200 OK
INFO:     127.0.0.1:52318 - "OPTIONS /api/profile HTTP/1.1" 200 OK
INFO:     127.0.0.1:52318 - "GET /api/profile HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:52318 - "GET /api/profile HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:58820 - "OPTIONS /api/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:58820 - "POST /api/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:58820 - "GET /api/profile HTTP/1.1" 200 OK
INFO:     127.0.0.1:58820 - "OPTIONS /api/tryon-history HTTP/1.1" 200 OK
INFO:     127.0.0.1:49817 - "OPTIONS /api/tryon-history HTTP/1.1" 200 OK
INFO:     127.0.0.1:49817 - "GET /api/tryon-history HTTP/1.1" 200 OK
INFO:     127.0.0.1:49817 - "GET /api/tryon-history HTTP/1.1" 200 OK
INFO:     127.0.0.1:49817 - "OPTIONS /api/products HTTP/1.1" 200 OK
INFO:     127.0.0.1:58820 - "OPTIONS /api/products HTTP/1.1" 200 OK
INFO:     127.0.0.1:49817 - "GET /api/products HTTP/1.1" 200 OK
INFO:     127.0.0.1:49817 - "GET /api/products HTTP/1.1" 200 OK
INFO:     127.0.0.1:55954 - "OPTIONS /api/tryon HTTP/1.1" 200 OK
MediaPipe not available
[API] Enhanced virtual try-on request from matthew.adebayo@nynox.solutions
[API] Using uploaded garment image (base64)
[API] FASHN processing failed: No module named 'google', falling back to local
[ERROR] Virtual try-on failed: 500: Customer pose detection failed
INFO:     127.0.0.1:55954 - "POST /api/tryon HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:63445 - "GET /health HTTP/1.1" 200 OK
